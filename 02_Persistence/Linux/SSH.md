# Persistence through SSH

Once gaining access to a system, we can try to find the SSH log on credentials (or create one ourselves with `ssh-keygen`). 
* private key: `~/.ssh/id_rsa`
* public key: `~/.ssh/id_rsa.pub`  (this should be saved in the server's `~/.ssh/authorized_keys`)

Copy the private key, maybe rename it, and `chmod 600 <KEY_NAME>`

`chmod 600` is important! Otherwise you won't be able to log in:
```
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Permissions 0644 for 'private-key' are too open.
It is required that your private key files are NOT accessible by others.
This private key will be ignored.
```

### Search for file
In general, to recursively search for a file: 
```
$ find / -name "id_rsa"
/root/.ssh/id_rsa
/root/.ssh/id_rsa.pub
```

### Log on
```
$ ssh username@remote_host -i <KEY_NAME>
```

### Public Key Auth Only
To disable password log in and allow ONLY public key authentication, in `/etc/ssh/sshd_config` you should have `PermitRootLogin without-password`
`
