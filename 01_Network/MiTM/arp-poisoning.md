# ARP Poisoning

[ARP poisoning in a switched network](http://articles.manugarg.com/arp_spoofing.pdf)

### Prep: Allow IP forwarding

Change the value in `/proc/sys/net/ipv4/ip_forward` from `0` to `1` to enable IP forwarding. 

### Option 1: arpspoof

If not yet installed, install with `sudo apt install dsniff`

Syntax:
```
$ sudo arpspoof -i tap0 -t <target-ip> <our-fake-ip>
```
* this tells the target what our (fake) IP is
* therefore, to poison full route (victim to gateway and gateway to victim), you have to run the command twice in two terminals, with the ip arguments switched up
* if the device has been hardened, you might see `coudln't arp for host ...`

Start WireShark before running arpspoof. 

### Option 2: Ettercap

Ettercap has a lot more MITM options, including DHCP poisoning and ICMP redirect. 

Basics: 
* Open the GUI, specify the interface, start `unified sniffing`, scan hosts in the subnet, and add target hosts to the target. 
* Then go to MITM menu and start ARP poisoning (similarly, start WireShark beforehand)

Ettercap to-do: try [bridged sniffing](https://linux.die.net/man/8/ettercap) some time. 
> Don't use it on gateways or it will transform your gateway into a bridge. HINT: you can use the content filtering engine to drop packets that should not pass. This way ettercap will work as an inline IPS ;) 
