# ICMP Redirect Attack

 ICMP redirect messages are usually sent by a router to a host to tell them there is a gateway on the LAN provifing a better metric for their packets to reach a certain destination. Once receiving this messgae, the host would update its route table. 
 
 ICMP redirect attack is done by the attacker sending a purposely crafted ICMP redirect message, telling the victim that they provide a better metric to a target destination, so the next time, traffic would be sent to the attacker. The attacker would then decide what to do with these packets. 

 Here's [an interesting real life story](https://www.agwa.name/blog/post/icmp_redirect_attacks_in_the_wild) of an ICMP Redirect attack

## How to prevent
Disable the reception of ICMP Redirect messages in hosts. 

Windows 2000 and Windows XP have ICMP Redirect option enabled but the modern ones don't. 

Linux has ICMP Redirect enabled by default. To disable:
```
$ echo 0 > /proc/sys/net/ipv4/conf/all/accept_redirects
$ echo 0 > /proc/sys/net/ipv4/conf/eth0/accept_redirects
# do this for all network interfaces
```

## How to attack

### option 1, ettercap

### option 2, scapy













